# 扩散模型DDPM
## 结构：级联去噪模型
## 步骤：
1. **前向扩散**:前向过程是加噪的过程，前向过程中图像 $x_t$ 只和上一时刻的 $x_{t-1}$ 有关, 该过程可以视为马尔科夫过程
2. **反向去噪**:逆向过程是去噪的过程，如果得到好的逆向过程就可以通过随机噪声 逐步还原出一张图像。DDPM使用神经网络  拟合逆向过程  。
![image.png](https://raw.githubusercontent.com/lishiyu2006/picgo/main/cdning/202509262221782.png)
attention：无论是前向过程还是反向过程都是一个参数化的[马尔可夫链](https://zhuanlan.zhihu.com/p/448575579)（Markov chain）（即当经过一定的训练负责还原或者加噪1%的这部分），其中反向过程可用于生成数据样本（它的作用类似GAN中的生成器，只不过GAN生成器会有维度变化，而DDPM的反向过程没有维度变化）

#### 一.前向过程
前向过程是加噪的过程,前向过程的图像 $x_t$ 值和上一时刻的 $x_{t-1}$ 有关,该工程可以视为马尔科过程
$q(x_{1:T}|x_0) = \prod_{t=1}^{T} q(x_t|x_{t-1})$
$q(x_t|x_{t-1}) = \mathcal{N}(x_t; \sqrt{1 - \beta_t}x_{t-1}, \beta_t I)$

$q(x_{1:T}|x_0)$表示的是从原始图像 $x_0$ 开始，经过 $T$ 步加噪过程后得到噪声图像 $x_t$ 的概率分布。

每一步 $q(x_t|x_{t-1})$ 表示:第 $t$ 步的噪声图像 $x_t$ ，是通过将第 $t-1$ 步的图像 $x_{t-1}$ 的像素值稍微缩小一点，然后给每个像素独立地添加一个强度为 $\beta_t$ 的[高斯噪声](../高斯噪声.md)得到的。

#### 二.逆向过程
逆向过程是去噪的过程,如果得到逆向过程 ，就可以通过随机噪声 逐步还原出一张图像。DDPM使用神经网络  拟合逆向过程  。
## 可以使用的神经网络：U-Net，Transformer
这里采用Unet实现正向的预测，整个训练过程其实就是在训练Unet网络的参数

### Unet职责:
无论在前向过程还是反向过程，Unet的职责都是根据当前的样本和时间t预测噪声。

### Gaussion Diffusion职责(**高斯扩散**):
